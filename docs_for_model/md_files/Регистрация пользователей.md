# Регистрация пользователей

## Общие сведения

Регистрация пользователя в системе состоит из следующих шагов:

1.  Создание учетной записи (пользователя) на сайте.

2.  Настройка права подписи руководителя и горизонтальных прав доступа.

3.  Создание записи в реестре сотрудников с указанием должности и подразделения, связка с учетной записью сайта.

Эти и другие шаги можно пройти при помощи интерфейса "Управление пользователями" <https://lexema-ecm.readthedocs.io/ru/latest/Admin%20manuals/framework/User%20managment/%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F%D0%BC%D0%B8/%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F%D0%BC%D0%B8/>,
 если соответствующий модуль был подключен к системе.

## Создание учетной записи {#createUser}

Для создания учетной записи пользователей администратору системы необходимо нажать на свой логин в верхней панели инструментов, выбрать пункт "Управление компаниями".

<figure class="figure-image">
  <img src="../adminMenu.png" alt="Рисунок 1. Служебное меню">
  <figcaption>Рисунок 1. Служебное меню</figcaption>
</figure>

Откроется реестр компаний "Мои компании". Администратору необходимо нажать на строку с нужной организацией, таким образом указывается организация, в которой будет регистрироваться сотрудник.

<figure class="figure-image">
  <img src="../companiesReg.png" alt="Рисунок 2. Пример реестра компаний" class="zoom">
  <figcaption>Рисунок 2. Пример реестра компаний</figcaption>
</figure>

Откроется форма "Компания", содержащая таблицу "Управление сотрудниками". Чтобы внести в таблицу нового сотрудника, необходимо нажать на кнопку "Создать сотрудника". 

<figure class="figure-image">
  <img src="../createUserButtonOnForm.png" alt="Рисунок 3. Расположение кнопки "Создать сотрудника"" class="zoom">
  <figcaption>Рисунок 3. Расположение кнопки "Создать сотрудника"</figcaption>
</figure>

Откроется форма "Сотрудник", в которой необходимо заполнить поля данными о сотруднике. 

    * Правило формирования логина: ФамилияИО (на латинице).
    * В поле "Пароль" указывается пароль для первого входа в систему. 
    * Пароль должен быть не менее 8 символов, содержать строчные и прописные буквы и цифры.
    * Поле "Телефон" заполняется в формате +79(...).

После заполнения всех полей необходимо нажать на кнопку "Сохранить и закрыть".

<figure class="figure-image">
  <img src="../createUserForm.png" alt="Рисунок 4. Пример регистрационных данных пользователя">
  <figcaption>Рисунок 4. Пример регистрационных данных пользователя</figcaption>
</figure>
<!-- ![Рисунок 4. Пример регистрационных данных пользователя](../createUserForm.png)  -->

После сохранения данных о сотруднике необходимо найти пользователя в таблице "Управление сотрудниками" и присвоить ему необходимые роли.

В случае, если в системе настроена доменная авторизация, необходимо поставить галочку в поле "Доменный" на странице создания пользователя и указать его логин в домене. После первой авторизации данные пользователя будут обновлены с учетом настроек системы.

<figure class="figure-image">
  <img src="../createDomainUser.png" alt="Рисунок 5. Создание доменного пользователя">
  <figcaption>Рисунок 5. Создание доменного пользователя</figcaption>
</figure>
<!-- ![Рисунок 5. Создание доменного пользователя](../createDomainUser.png)  -->

## Редактирование пользователя

Присвоение ролей пользователю производится при редактировании пользователя. Для этого необходимо нажать на строку таблицы "Управление сотрудниками" с логином пользователя. 

<figure class="figure-image">
  <img src="../newUserInTable.png" alt="Рисунок 6. Строка с новым пользователем в таблице "Управление сотрудниками"" class="zoom">
  <figcaption>Рисунок 6. Строка с новым пользователем в таблице "Управление сотрудниками"</figcaption>
</figure>

Откроется форма "Сотрудник". В форме содержатся неизменяемые поля "Логин" и "ФИО", а также редактируемые: статус сотрудника (поле "Статус"), состояние блокировки (поле для галочки "Блокировка") и роли сотрудника (таблица "Роли"). 

<figure class="figure-image">
  <img src="../newUserDetail.png" alt="Рисунок 7. Форма "Сотрудник" нового пользователя">
  <figcaption>Рисунок 7. Форма "Сотрудник" нового пользователя</figcaption>
</figure>
<!-- ![Рисунок 7. Форма "Сотрудник" нового пользователя](../newUserDetail.png)  -->

В статусе сотрудника можно указать, является сотрудник администратором или пользователем. В таблице "Роли" построчно указываются все роли сотрудника. Поле "Блокировка" позволяет заблокировать доступ сотрудника в компанию. Служит заменой удалению логина из системы.

Сохранение изменений производится с помощью кнопок "Сохранить" и "Сохранить и закрыть".

## Назначение ролей {#roles}

В системе существует разграничение прав доступа в соответствии с присвоенными пользователю ролями. Чтобы присвоить необходимые роли необходимо нажать на строку таблицы "Управление сотрудниками" с логином пользователя. Откроется форма "Сотрудник". В форме содержится таблица "Роли", чтобы её заполнить необходимо нажать на кнопку "Добавить". 

<figure class="figure-image">
  <img src="../newUserDetailRoles.png" alt="Рисунок 8. Заполнение таблицы "Роли"">
  <figcaption>Рисунок 8. Заполнение таблица "Роли"</figcaption>
</figure>
<!-- ![Рисунок 8. Заполнение таблицы "Роли"](../newUserDetailRoles.png) -->

Описание ролей в системе можно найти в разделе [Роли системы](./../Роли/Роли.md).

После присвоения роли сотруднику необходимо сохранить изменения с помощью кнопки "Сохранить" или "Сохранить и закрыть". Внесенные изменения отразятся в таблице "Управление сотрудниками". Именно он рекомендуется к использованию для создания, редактирования, настройки пользователей и назначения им ролей, а также создания и привязки их к физическим лицам.

## Добавление прав на организацию пользователям

Чтобы добавить сотрудника другой организации в таблицу "Управление сотрудниками", необходимо нажать на кнопку "Найти сотрудника" на панели инструментов.

<figure class="figure-image">
  <img src="../findUserButton.png" alt="Рисунок 9. Кнопка "Найти сотрудника" на форме "Компания"" class="zoom">
  <figcaption>Рисунок 9. Кнопка "Найти сотрудника" на форме "Компания"</figcaption>
</figure>

Откроется всплывающее окно "Поиск сотрудников". В поле "Логин или ФИО" необходимо ввести (полностью или частично) ФИО или логин сотрудника и нажать на кнопку "Найти". Если не заполнить поле "Логин или ФИО", то при нажатии на кнопку "Найти" в таблицу будут загружены все пользователи системы. 

<figure class="figure-image">
  <img src="../findUserEnterFIO.png" alt="Рисунок 10. Расположение элементов управления для переноса пользователей в окне "Поиск сотрудников"" class="zoom">
  <figcaption>Рисунок 10. Расположение элементов управления для переноса пользователей в окне "Поиск сотрудников"</figcaption>
</figure>

В таблице отобразятся результаты поиска. В полях таблицы можно проверить к какой компании относится сотрудник, какие роли у него имеются и состояние блокировки сотрудника. Если сотрудник уже имеется в текущей компании, то такая запись в результаты не попадает. 

Чтобы добавить выбранных в таблице сотрудников в редактируемую компанию, необходимо нажать на строку с искомым сотрудником и нажать на кнопку "Добавить". 

По умолчанию сотрудник добавится в таблицу "Управление сотрудниками" без присвоенных ранее ролей. Чтобы сохранить уже присвоенные роли в организации найденного сотрудника при добавлении в текущую организацию, необходимо поставить галочку в поле "Перенос ролей".

<figure class="figure-image">
  <img src="../findUserChoosing.png" alt="Рисунок 11. Выбор пользователя для переноса" class="zoom">
  <figcaption>Рисунок 11. Выбор пользователя для переноса</figcaption>
</figure>

Поскольку сотрудник может быть добавлен в несколько компаний, все они могут отображаться в результатах. В ситуации, когда необходимо перенести такого сотрудника, необходимо выбрать только одну запись. При попытке перенести одного и того же пользователя из нескольких организаций операция не будет выполнена и появится соответствующее предупреждение.

В результате сотрудник будет добавлен в таблицу "Управление сотрудниками". Добавленный пользователь будет обладать правами доступа в соответствующей организации. 

<figure class="figure-image">
  <img src="../findUserFinished.png" alt="Рисунок 12. Перенесённый из другой компании пользователь" class="zoom">
  <figcaption>Рисунок 12. Перенесённый из другой компании пользователь</figcaption>
</figure>

После этого необходимо создать документ в реестре [Настройка пользователей](./../Настройка пользователей/Настройка пользователей.md) и привязать пользователя к сотруднику из реестра [Сотрудники](../../Lexema-ERP/Общие справочники/Справочники.md#физические_лица).


## Настройка прав замещения

Замещение – процесс работы одного пользователя (замещающий) под правами другого (замещаемый). При этом замещающий работает только с правами замещаемого, т.е. права не объединяются. Используется, к примеру, когда начальник отдела уходит в отпуск и его заместитель работает с его документами.

Ниже таблицы "Управление сотрудниками" расположена таблица "Управление замещениями". Чтобы настроить замещение сотрудника другим сотрудником, необходимо нажать на кнопку "Добавить". 

<figure class="figure-image">
  <img src="../substitutionAddButton.png" alt="Рисунок 13. Расположение таблицы "Управление замещениями"" class="zoom">
  <figcaption>Рисунок 13. Расположение таблицы "Управление замещениями"</figcaption>
</figure>

В табличную часть добавится новая строка, её необходимо заполнить нужной информацией. Для того чтобы изменения вступили в силу, необходимо сохранить документ, нажав на кнопку "Сохранить" на панели инструментов.

> Поля "Дата начала" и "Дата окончания" не обязательны к заполнению. В случае, если информация в них не указана – замещение считается настроенным бессрочно.

<figure class="figure-image">
  <img src="../substitutionAdded.png" alt="Рисунок 14. Пример настройки прав замещения" class="zoom">
  <figcaption>Рисунок 14. Пример настройки прав замещения</figcaption>
</figure>

Для удаления строки с замещением необходимо выделить строку и нажать на кнопку "Удалить". Для того чтобы изменения вступили в силу, необходимо сохранить документ, нажав на кнопку "Сохранить" на панели инструментов.

<figure class="figure-image">
  <img src="../substitutionDelButton.png" alt="Рисунок 15. Настройка прав замещения" class="zoom">
  <figcaption>Рисунок 15. Настройка прав замещения</figcaption>
</figure>