# Описание настроек на стороне 1С

Для отладки обмена данными между системами СЭД и 1C, необходимо предоставить доступ к серверу 1С. <br>
Это должно быть VPN-соединение (обязательно для отладки сервиса загрузки данных из 1С) и дополнительно <br>
подключение через RDP. В случае предоставления доступа по RDP необходимо установить программы: <br>
pgAdmin, Postman, Google Chrome.
Также на время тестирования необходимо развернуть копию базы 1С. <br>
К копии базы должен быть доступ со стороны специалистов ООО «Лексема», а также ответственных за внедрение КЭДО специалистов со стороны заказчика. <br>
Во время тестирования осуществляется проверка по всем запланированным к обмену документам с продуктивной базой Lexema-ECM. К запуску пилотного проекта база Lexema-ECM будет очищена от тестовых документов.<br>    

Для того, что настроить обмен данными между системами СЭД и 1C по интерфейсам API, необходимо произвести следующие *настройки на стороне системы 1С*:<br>
1.	Опубликовать работу с OData в конфигураторе базы. <br>
Публикация сервисов OData выполняется из меню Конфигуратора «Администрирование -> Публикация на веб-сервере», флажок «Публиковать стандартный интерфейс OData».<br>

2.	Создать пользователя, через которого будет осуществляться обмен, с полными правами на выполнение методов get и post.<br>

3.	Опубликовать в 1с следующие каталоги справочников:<br>

* Catalog_ФизическиеЛица<br>
* InformationRegister_ФИОФизическихЛиц
* Catalog_ВидыДокументовФизическихЛиц<br>
* Catalog_ВидыКонтактнойИнформации<br>
* InformationRegister_ДокументыФизическихЛиц<br>
* InformationRegister_СклоненияПредставленийОбъектов<br>
* Catalog_Сотрудники<br>
* InformationRegister_КадроваяИсторияСотрудников<br>
* InformationRegister_ВидыЗанятостиСотрудников<br>
* Catalog_Должности<br>
* Catalog_ПодразделенияОрганизаций<br>
* Catalog_Организации<br>
* Catalog_ВидыОтпусков<br>
* Catalog_Пользователи<br>
* Catalog_ИзменениеОплатыТрудаПрисоединенныеФайлы
* Catalog_РаботаВВыходныеИПраздничныеДниПрисоединенныеФайлы
* Catalog_ОтгулПрисоединенныеФайлы
* Catalog_СовмещениеПрисоединенныеФайлы 
* InformationRegister_ОсновныеДанныеКонтрактаДоговораСотрудника


4.	Опубликовать в 1с каталоги документов,  обмен которыми планируется осуществлять, например:   

* Document_ОтпускБезСохраненияОплаты
* Document_КомандировкиСотрудников 
* Document_ТабельУчетаРабочегоВремени 
* Document_СправкаНДФЛ
* Document_ПриемНаРаботу
* Document_ПереносОтпуска
* Document_ГрафикОтпусков
* Document_ОтпускПоУходуЗаРебенком
* Document_ВозвратИзОтпускаПоУходуЗаРебенком
* Document_ИзменениеГрафикаРаботыСписком
* Document_МатериальнаяПомощь
* Document_КадровыйПеревод
* Document_ЗаявлениеВФССОВозмещенииРасходовНаПогребение
* Document_ЗаявлениеНаПредоставлениеСтандартныхВычетовПоНДФЛ
* Document_ЗаявлениеСотрудникаНаВыплатуПособия
* Document_ПрогулНеявка
* Document_СправкаНДФЛ
* Document_Командировка
* Document_ОплатаДнейУходаЗаДетьмиИнвалидами
* Document_Увольнение
* Document_ОплатаПоСреднемуЗаработку
* Document_ОтпускБезСохраненияОплаты
* Document_КомандировкиСотрудников 
* Document_ТабельУчетаРабочегоВремени 
* Document_СправкаНДФЛ
* Document_ПриемНаРаботу 
* Document_ПереносОтпуска
* Document_ГрафикОтпусков 
* Document_ОтпускПоУходуЗаРебенком 
* Document_ВозвратИзОтпускаПоУходуЗаРебенком 
* Document_ИзменениеГрафикаРаботыСписком
* Document_МатериальнаяПомощь
* Document_КадровыйПеревод
* Document_ЗаявлениеВФССОВозмещенииРасходовНаПогребение
* Document_ЗаявлениеНаПредоставлениеСтандартныхВычетовПоНДФЛ
* Document_ЗаявлениеСотрудникаНаВыплатуПособия
* Document_ПрогулНеявка
* Document_СправкаНДФЛ
* Document_Командировка
* Document_ОплатаДнейУходаЗаДетьмиИнвалидами
* Document_Увольнение
* Document_ОплатаПоСреднемуЗаработку
* Document_БольничныйЛист<br>
* Document_РаботаВВыходныеИПраздничныеДни
* Document_Отгул
* Document_Совмещение
* Document_ИзменениеОплатыТруда
* Document_Увольнение

5.	Для обмена файлами необходимо опубликовать следующие сущности:<br>
* InformationRegister_ДвоичныеДанныеФайлов – один регистр для всех документов,необходим **полный доступ**.<br>
* Каталоги присоединенных файлов, обмен которыми планируется осуществлять,<br> **Catalog**_*НАЗВАНИЕ***ПрисоединенныеФайлы**, например:<br>

* Catalog_ОтпускПрисоединенныеФайлы
* Catalog_ОтпускБезСохраненияОплатыПрисоединенныеФайлы
* Catalog_КомандировкиСотрудниковПрисоединенныеФайлы
* Catalog_ТабельУчетаРабочегоВремениПрисоединенныеФайлы
* Catalog_СправкаНДФЛПрисоединенныеФайлы
* Catalog_ПриемНаРаботуПрисоединенныеФайлы
* Catalog_ПереносОтпускаПрисоединенныеФайлы
* Catalog_ГрафикОтпусковПрисоединенныеФайлы
* Catalog_ОтпускПоУходуЗаРебенкомПрисоединенныеФайлы
* Catalog_ВозвратИзОтпускаПоУходуЗаРебенкомПрисоединенныеФайлы
* Catalog_ИзменениеГрафикаРаботыСпискомПрисоединенныеФайлы
* Catalog_МатериальнаяПомощьПрисоединенныеФайлы,<br>
* Catalog_КадровыйПереводПрисоединенныеФайлы,<br>
* Catalog_ЗаявлениеВФССОВозмещенииРасходовНаПогребениеПрисоединенныеФайлы,<br>
* Catalog_ЗаявлениеНаПредоставлениеСтандартныхВычетовПоНДФЛПрисоединенныеФайлы,<br>
* Catalog_ЗаявлениеСотрудникаНаВыплатуПособияПрисоединенныеФайлы,<br>
* Catalog_ПрогулНеявкаПрисоединенныеФайлы,<br>
* Catalog_СправкаНДФЛПрисоединенныеФайлы,<br>
* Catalog_КомандировкаПрисоединенныеФайлы,<br>
* Catalog_ОплатаДнейУходаЗаДетьмиИнвалидамиПрисоединенныеФайлы,<br>
* Catalog_УвольнениеПрисоединенныеФайлы,<br>
* Catalog_ОплатаПоСреднемуЗаработкуПрисоединенныеФайлы,<br>
* Catalog_БольничныйЛистПрисоединенныеФайлы <br>
* Catalog_РаботаВВыходныеИПраздничныеДниПрисоединенныеФайлы
* Catalog_ОтгулПрисоединенныеФайлы
* Catalog_СовмещениеПрисоединенныеФайлы
* Catalog_ИзменениеОплатыТрудаПрисоединенныеФайлы
 

Для тестирования работы протокола (проверить права доступа на чтение сущностей 1С) открываем любой доступный браузер и в адресной строке вводим url согласно шаблона:<br>
http://<имя сервера>:<порт>/<имя публикации>/odata/standard.odata/<имя ресурса><формат полученных данных>

где:<br>
*	имя сервера – имя веб-сервера или его ip адрес, так же если веб-сервер установлен на ПК, где вы открыли браузер можно ввести localhost или 127.0.0.1 (например: http://localhost/ или http://server1c/);<br>
*	порт – порт веб-сервера. Если используется стандартный порт 80, тогда можно не указывать порт (например: http://localhost/smallbusiness/);<br>
*	имя публикации – имя, которое было указано при публикации в конфигураторе 1С 8 (например: smallbusiness);<br>
*	имя ресурса – имя одного из получаемых ресурсов метаданных (справочники, документы, регистры и т.п.) с установленными фильтрами (например: Catalog_*НАЗВАНИЕ*);<br>
*	формат полученных данных – указываем «?$format=json» для формата json или «?$format=atom» для формата xml.<br>

(https://**<имя сервера>:<порт>**/odata/standard.odata/Catalog_*НАЗВАНИЕ*?$format=json)<br>
Например:<br>
*http://server1c.lex.lan/DemoHRM/odata/standard.odata*
