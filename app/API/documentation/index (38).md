# Настройка интеграции с мессенджером Telegram 

В системе реализована возможность получения уведомлений о необходимости обработки документов через мессенджер Telegram.

Для того, чтобы подключить данный функционал, необходимо:

1.	Выделить телефонный номер с подключением с аккаунтом в Telegram, от имени которого будет идти рассылка уведомлений. Рекомендуется не использовать личные аккаунты. При необходимости можно использовать отдельные номера телефонов для каждой организации.

2.	Зарегистрировать данный номер телефона на сайте [мессенджера](https://my.telegram.org/auth) и получить идентификаторы API.

3.	Привязать в Лексеме номер телефона к организации/организациям. Ниже подробно описаны действия, которые необходимо выполнить на каждом шаге.

**Шаг 1**

Выделить номер телефона и зарегистрировать его в Telegram. Данный шаг является организационным.

**Шаг 2** 

Для того, чтобы получить идентификатор API , необходимо перейти на сайт и ввести номер телефона, с которого будут отправляться уведомления пользователям. На этот номер будет направлен код подтверждения, который необходимо ввести  в соответствующее поле. После этого необходимо нажать "Войти"

![Номер](media/number.png)

![Код](media/code.png)

* Перейдите в «Инструменты разработки API»

![Инструменты](media/tools.png)

* Заполните форму

![Форма](media/form.png)

* Вы получите базовые адреса, а также параметры api_id и api_hash , необходимые для авторизации пользователя. Рекомендуется их сохранить в текстовый файл.

![Конфиг](media/config.png)

!!! note
    На данный момент к каждому номеру может быть подключен только один **api_id**.

!!! warning
    Сервис Telegram будет направлять важные уведомления разработчиков на номер телефона, который вы используете в этом процессе, поэтому, пожалуйста, используйте актуальный номер, связанный с вашей активной учетной записью Telegram.

После подтверждения в системе появится уведомления, что пользователь авторизован. В мессенджере  Telegram поступит сообщение , что был осуществлен вход с нового устройства.

**Шаг 3**

Теперь остается привязать зарегистрированный номер телефона к каждой организации.
Для настройки необходимо открыть Меню - Администрирование - Система - Настройки телеграм организаций

Для настройки необходимо открыть Меню - Администрирование - Система - Настройки телеграм организаций

![Меню](media/menu.png)

В списке организаций выберите ту, к которой хотите привязать данный номер телефона

![Компании](media/companies.png)

В поле **Телеграм Телефон** введите номер телефона, в полях **Телеграм API_ID** и **Телеграм API_HASH** введите  данные, полученные на предыдущем шаге.

![Авторизация](media/api.png)

Нажмите «Авторизоваться с кодом подтверждения». В Telegram придет код подтверждения, который необходимо ввести в всплывающем окне на сайте.

![Код подтверждения](media/codeTelega.png)

![Подтверждение](media/codePodtver.png)

!!! warning
    В случае если в холдинге у всех организаций номер телеграма один и тот же - то авторизоваться достаточно один раз в на основном филиале. На каждом филиале необходимо прописывать **api_id** и **api_hash**

Если авторизация прошла успешно – выйдет соответствующее сообщение:

![Система](media/pushSys.png)

В Telegram отобразится информация о  подключении:

![Телеграм](media/messageTel.png)

В поле "Статус сервиса" отображается успешное/не успешное подключение к сервису:

![Сервис](media/status.png)

!!! note
    Примечание: если статус сервиса сообщает о неуспешной авторизации – обратитесь в техническую поддержку Lexema-ECM

Для получения уведомления у пользователя должна быть подключена опция получения уведомления через Telegram в [Управлении пользователями](../Управление пользователями/index.md#создание_пользователя).

При поступлении документа на обработку пользователю придет соответствующее уведомление в мессенджере.

![Телега](media/telega.png)

Чтобы настроить невозможность отправки сообщений на номер телефона Telegram пользователю , необходимо перейти Настройки - Конфиденциальность - Номер телефона -  в настройке "Кто видит мой номер телефона" выбрать **Никто** и нажать "Сохранить". При таких настройках посторонние люди, которые знают номер телефона, не смогут писать сообщения на указанный номер.

![](media/conf.png)