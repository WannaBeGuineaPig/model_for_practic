# FAQ Lexema-ECM

## Работа с документами и маршрутами

??? question "Как подключить документ к СЭД?"

	A: Сначала надо описать подключаемую форму в документе «Настройка документов». Прописать там и схему, и название форм, и т.д. и т.п. Подробнее про форму и её галки можно почитать в [инструкции](https://ecm-administrator-manuals.readthedocs.io/ru/latest/Admin%20manuals/%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0%20%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%BE%D0%B2/).
	Есть общая документооборотная вьюшка DocflowExists,
	она на каждом проекте настраивается отдельно. В ней нужно перечислить все таблицы, которые будут участвовать в документообороте. И вьюшку DocflowAccess, она похожа на DocflowExists, но задаёт ограничения по правам.
	Желательно обновить до последних стабильных версий Ядро (+все сопутствующие ядерные зависимости) ,Общие справочники и Карточки СЭД. Если планируется подписание ЭП - подключить сервис [dss](https://ecm-system-settings.readthedocs.io/ru/latest/Admin%20manuals/service/dss/configuration/).
	Подключить в меню (units.json) документы.
	Если у документов предусмотрены подтипы - завести подтипы в соответствующем реестре Подтипы документов.
	Настроить шаблоны маршрутов.

	Если подключаете ЭП - сгенерировать гамма-последовательности на сервере (к сисадмину)

	В самих формах маршрут подключается при помощи 

	```javascript
	this.services.docflow.connectForm({ context: this, docArgs: args })
	```
	Там же обычно подключаются список рассылки, связки и вложения. Примеры можно посмотреть в библиотеке ecosoft-lexema8-docflow-documents-lib (Карточки СЭД)

??? question "Как создать новый вид заявления?"
    
    см. статью [Конструктор документов](../Конструктор документов/)

??? question "Как создать новый маршрут к заявлению?"

    см. статью [ Шаблоны маршрутов](../Настройка шаблонов маршрутов/)

??? question "Почему я не могу создать ЛНА?"
    
    Создание ЛНА доступно только ответственным сотрудникам организации, поэтому этим пользователям необходимо дать в системе дополнительные права. Для этого нужно пройти в справочник "Подтипы документа" и указать в таблице "Пользователи с правом создания" этих пользователей. Подробнее см. статью [Подтипы документов](../Подтипы документов/)

??? question "Почему я не вижу документ в реестре?"
    
    По умолчанию во всех реестрах системы Lexema-ECM пользователь видит документы, если 

    а) он сам является автором этих документов

    б) он участвовал в маршруте этих документов, даже если сам не является автором

    в) он получил документ посредством списка рассылки

    При необходимости можно дать так называемые горизонтальные права -то есть возможность видеть документы других подразделений при том, что в вышеописанные условия не попадает (кас. предоставления горизонтальных прав - см. статью [Настройка пользователей](../Настройка пользователей/).
    Если пользователь не видит документ - вероятнее всего он не подходит ни под одно из вышеописанных условий.

??? question "Как мне или администратору отредактировать маршрут согласования?"
    
	С помощью [формы корректировка маршрутов согласования](https://ecm-user-manuals.readthedocs.io/ru/latest/User manuals/Форма корректировки маршрутов согласования/)

??? question "У совместителя автоматически не протиражировалось заявление на других местах работы"

	Необходимо проверить следующие условия:
	* У совместителя должна быть проставлена "Дата перехода на КЭДО" в карточке сотрудника по каждому Сорг.
	* Совместитель не должен быть уволен/заблокирован по другим местам работы (то есть на других Сорг).
	* В конструкторе документов во вкладке "Тиражирование/Оповещение" должна быть проставлена галка "Тиражировать заявления для совместителей", и он должен быть доступен на каждом филиале.
	* На каждом филиале должен быть настроен пользователь с логином `CopyEmployee` и автоматическое тиражирование заявлений.

??? question "В меню не вижу какую-то форму, например, Анализ сотрудников по КЭДО"

	Проверить наличие роли на данную форму у пользователя.

??? question "К пользователю пришел документ на обработку с пустым подтипом"

	Проверить наличие конструктора для данного подтипа на Сорг.
	Пример: Конструктор заведен только на одном Сорг, а на другом его нет.


??? question "В реестре заявлений у пользователя с настроенными горизонтальными правами не видно заявления, в то время как данное заявление видно через форму журнала состояния документов, в форме корректировки маршрута, а также в СУБД"

	Возможно, в данном заявлении не заполнилось поле подразделение. В реестре настроена проверка на горизонтальные права по полю подразделение.

??? question "При обработке документов выходит окно для подтверждения обработки (подписания), хотя в шаблоне настроено, чтобы не показывалось"

	Убрать галку "Комментировать вложения при согласовании" в Настройке документов.

??? question "В служебной записке при создании маршрута он как бы создается, но потом исчезает. В БД у такого документа статус у маршрутов — 4 (удален)"

	Обновить `serviceRecord_AfterCreateRoute`.

??? question "Наблюдаются ошибки в логах при отправке по маршруту: Credential implementation provided to initializeApp() via the "credential" property failed to fetch a valid Google OAuth2 access token with the following error: \"Error fetching access token: Error while making request: connect ETIMEDOUT 64.233.164.84:443.\""

	Ошибка связана с push-уведомлениями и означает, что Лексема не имеет доступа до сервисов Google, которые отправляют пуши.
	Необходимо открыть Лексеме доступ до этих адресов: [https://firebase.google.com/docs/cloud-messaging/concept-options?hl=en#messaging-ports-and-your-firewall](https://firebase.google.com/docs/cloud-messaging/concept-options?hl=en#messaging-ports-and-your-firewall).


??? question "Не приходят уведомления на почту при отправке документа по маршруту"

	1) Проверить наличие адреса в глобальных настройках.
	2) Проверить наличие конструктора уведомления с типом "О поступлении в работу".

## Работа с электронными подписями

??? question "Почему при выпуске УНЭП не появляются ссылки для скачивания заявки на выпуск ЭП и расписки в получении ЭП?"

    Для выпуска сертификата УНЭП пользователь системы должен быть привязан к конкретному физическому лицу.
    Для этого нужно 

    1) пройти в раздел Меню - группа "Администрирование" - группа "Управление пользователями" -  пункт "Управление пользователями".

    2) в загрузившемся списке найти нужный логин и выделить галочкой

    3) нажать "Данные пользователя" - выбрать физическое лицо в выпадающем списке - и нажать "Сохранить"

??? question "Как подписать документ квалифицированной подписью?"
    
    Прежде чем использовать КЭП, необходимо настроить рабочее место пользователя соответствующим образом. Для настройки - см. статью [Как настроить работу с КЭП на токенах](../Настройка для токенов КЭП/)

??? question "Возможно ли подтверждать операции подписания по SMS?"
    
    Да, возможно. Для этого необходимо пройти Меню -  группа "Администрирование" - группа "Система" - пункт "Глобальные настройки".
    Нажать кнопку "Настройка" и выключить флаг "Отключить подтверждение ЭЦП по СМС (новые сертификаты)"
    ![Подтверждение через смс](./media/apprbysms.png)
 
??? question "Что делать если по кнопке Добавить сертификат - список сертификатов пустой?"
    
	1) см. статью [Привязка КЭП к пользователю Lexema-ECM](../Настройка для токенов КЭП/#шаг_3_привязка_кэп_к_пользователю_lexema-ecm).

	Как добавить в личное хранилище импортированные сертификаты?</br>

	![csp1](media/csp1.PNG)</br>
	![csp2](media/csp2.PNG)</br>
	![csp3](media/csp3.PNG)</br>
	![csp4](media/csp4.PNG)</br>
	![csp5](media/csp5.PNG)</br>
	![сертификаты-личное](media/сертификаты-личное.PNG)</br>

	2) Нажмите сочетание клавиш  `Win + R`

	Введите `certmgr.msc` и нажмите клавишу Enter.

	![Alt text](media/image-1.png)

	Откроется Консоль управления сертификатами.

	![Alt text](media/image.png)

??? question "При привязке УКЭП к пользователю ошибка: ` /#/view/1474:1  Access to XMLHttpRequest at 'http://localhost:9421/' from origin '' has been blocked by CORS policy: No 'Access-Control-Allow-Origin' header is present on the requested resource.`"

	В конфигурационном файле (файл CSPServer.exe с расширением .config) в секции AvailableDomains должен быть прописан адрес сайтаы. Подробнее про привязку токенов по КЭП можно ознакомиться в соответствующем [разделе](../Настройка для токенов КЭП/index.md)

??? question "В логах при отправке по маршруту у пользователя с действием подписать ЭП наблюдается ошибка: Ошибка при подписании файла. `code = 45. ../../../../CSPbuild/CSP/samples/CPCrypt/Certs.cpp:290: 0x2000012D [ErrorCode: 0x2000012d]`"

	Эта ошибка означает, что на сервере нет сертификата на пользователя. Запись может быть во всех нужных таблицах, но физического сертификата нет.
	1) Посмотреть, где хранятся записи о кривом сертификате:
	```sql
	SELECT *
	FROM lex."CloudCertificate" c
	JOIN lex."UserMeta" l ON c."User" = l."Id"
	WHERE l."UserName" = 'логин_пользователя'
	```
	2) Удалить эти записи из заявок на выпуск:
	```sql
	SELECT *
	FROM comdoc."ECPCertificateApplication"
	WHERE "CertificateId" IN (
	    SELECT c."Id"
	    FROM lex."CloudCertificate" c
	    JOIN lex."UserMeta" l ON c."User" = l."Id"
	    WHERE l."UserName" = 'логин_пользователя'
	)
	```
	3) Удалить эти записи из таблицы сертификатов:
	```sql
	SELECT c."Id"
	FROM lex."CloudCertificate" c
	JOIN lex."UserMeta" l ON c."User" = l."Id"
	WHERE l."UserName" = 'логин_пользователя'
	```
	4) Перевыпустить сертификат пользователю в разделе "Сертификаты пользователя", либо из ЛК HR, либо самостоятельно пользователю в виджете Документооборот/Электронные подписи по кнопке

??? question "Я зашел под замещением в программу. Чей сертификат ЭП я вижу?"

	Под замещением всегда виден сертификат, который выпущен на самого себя. Сертификаты ЭП никогда не замещаются, потому что выпускаются на физическое лицо. Если бы сертификаты замещались, это было бы равносильно подписанию заявления мокрой подписью чужой рукой.

??? question "На проекте для ЭЦП используется система корневых сертификатов. Что делать, если они просрочились? (Или \"При выпуске УНЭП ошибка в логах ошибка 0x80090010\")"

	Данная ошибка связана с тем, что у корневых сертификатов закончился срок действия (максимальный срок может быть 1 год и 3 месяца).
	Их необходимо перевыпустить и переустановить:
	1) Пройти в инструкцию и выпустить корневые сертификаты в формате pfx. Их должен выпустить заказчик.
	2) Передать их сотруднику Лексема или ответственному за деплой сайта вместе с паролями и отпечатками.
	3) Все сертификаты поместить в архив (`certificates.tar`) без подпапок.
	4) Положить их в папку `dss` в деплой-проекте.
	5) В файле `import-cert.sh` прописать импорт и установку (примеры команд можно посмотреть тут).
	6) Задеплоить проект.
	7) В управлении компаниями пройти в каждую компанию и в поле "Отпечаток" прописать отпечаток сертификата от соответствующей компании.

??? question "Дали шедулеру все роли (DssAdmin, super, allmodels, allqueries, docflow), статус Администратор на всех филиалах, а он всё равно не может выпускать сертификаты. Чего ещё надо?"

	Обратить внимание на запрос в логах ошибок. Там может быть указан код несуществующей (недосозданной) организации. Надо её завершить.

??? question "При привязке УКЭП к пользователю ошибка: /#/view/ECPCertificateApplicationForm/1474:1 Access to XMLHttpRequest at 'http://localhost:9421/' from origin 'АдресСайта' has been blocked by CORS policy: No 'Access-Control-Allow-Origin' header is present on the requested resource"

	В конфигурационном файле (`CSPServer.exe` с расширением `.config`) в секции `AvailableDomains` должен быть прописан адрес сайта.
	Подробнее про привязку токенов по КЭП: [соответствующий раздел].

??? question "Ошибка при подписании КЭП: lost connection to extension"

	Проверить вложения, сжать файлы, чтобы общий размер подписываемых вложений был не более 25 МБ.
	[https://support.cryptopro.ru/index.php?/Knowledgebase/Article/View/213/12/ogrnichenie-n-rzmer-podpisyvemogo-fjjl-v-bruzere](https://support.cryptopro.ru/index.php?/Knowledgebase/Article/View/213/12/ogrnichenie-n-rzmer-podpisyvemogo-fjjl-v-bruzere)
	Для сжатия: [https://www.ilovepdf.com/ru/compress_pdf](https://www.ilovepdf.com/ru/compress_pdf).

## Работа с пользователями

??? question "Как создать нового пользователя?"
    
    см. статью [Управление пользователями](../Управление пользователями/)

??? question "Если множится пользователь в Управление пользователями"

	Проблем может быть несколько:
	1) Задвоился логин в карточке ФЛ.
	2) В настройках пользователей создалось более одного пользователя.

??? question "При интеграции с 1С выходит ошибка: Сущность: 'Document_(наименование сущности)' ошибка при выполнении обработчика - 'ПередЗаписью'"

	В правах пользователя (прописан в `production.js`), настроен доступ только на чтение данных.
	Необходимо запросить полные права для данного пользователя у администратора 1С со стороны заказчика.
	Источник: [https://forum.infostart.ru/forum9/topic265337/](https://forum.infostart.ru/forum9/topic265337/)

## Настройка интеграции с 1С

??? question "Как настроить интеграцию любого произвольного документа, например, управленческой структуры"

    Для загрузки данных управленческой структуры необходимо настроить "Произвольные выборки" 
    Подробнее о настройке см. статью [Произвольные выборки](../Настройка для интеграции с 1С/Настройка интеграции справочников и документов/Вкладка Произвольные выборки/).

??? question "Обмен с 1С. Не загружаются сотрудники. Доступ до сущности есть, физические лица и прочие загружаются. В чем дело?"

	Скорее всего, Лексема не понимает соответствие организаций, либо они сопоставлены неправильно.
	Пройти в "Настройки параметров обмена с 1С", вкладка "Соответствие справочников".
	Должно быть: одна организация 1С — одна организация Лексема.

??? question "При интеграции из 1С физического лица не подтянулись данные по электронной почте, телефону, образовании и т.п."

	В форме "Настройка параметров обмена с 1С" сделать соответствие со справочниками Лексемы и 1С в соответствующей вкладке.

??? question "При интеграции служебной записки на командировку неверно заполняются данные по указанию расчетного периода. Например, расчет командировки должен считаться по среднему за прошлый год, т.е. период Апрель 2023 — Март 2024"

	Необходимо обновить `odata."getEmployeeStatement"`.

## Работа с системой

??? question "Как изменить часовой пояс в системе (Postgre SQL)?"
    
    Необходимо выполнение следующих команд в PgAdmin
    ```sql
    select localtimestamp; /*возвращает текущую дату и время в часовом поясе из сеанса sql*/
    select current_timestamp; /*возвращает текущие дату и время из сеанса пользователя*/
    SELECT NOW(); --посмотреть серверное время 
    SELECT * FROM pg_timezone_names; -- посмотреть типы часовых поясов
    ALTER SYSTEM SET timezone TO 'Europe/Moscow'; -- изменение часового пояса
    ```
    Подробно о часовых поясах в Postge SQL можно узнать [здесь](https://it-blackcat.blogspot.com/2019/10/postgresql-and-timezone.html)

??? question "Если возникает ошибка при обращении к домену, например по кнопке Импорт из AD"

    ![Импорт из AD](./media/Импорт из AD.png)
    ![Ошибка интеграции с доменом](./media/ошибка интеграции с доменом.png)

    Необходимо проверить заполнение файла `production.js`, где указан полный путь до юнита с пользователями  ldap: { ..bindDN:
  
    Параметры полного пути до юнита с пользователями необходимо запрашивать у системных администраторов

    посмотреть параметры можно в  cmd командой `whoami /fqdn`

??? question "Как посмотреть версии библиотек, установленные на проекте?"
    
    В служебном меню, открывающемся при нажатии на имя пользователя в правом верхнем углу страницы приложения нажмите кнопку "О системе"

    ![О системе](media/menuUser.png)

    ![Библиотеки](media/library.png)

??? question "Как правильно использовать Cron при создании расписания сервиса **sheduler**?"

	Чтобы правильно настроить расписание в данном формате, перейдите [по ссылке](https://crontab-generator.com/ru). Сервис использует серверное время, где развернут сервис.

	Примеры использования crontab:

	Описание | Вычисление
	---------|-----------
	каждые 30 минут каждый день | 30 &lowast; &lowast; &lowast; &lowast; |
	каждые 60 минут каждый день | 0 &lowast; &lowast; &lowast; &lowast; |
	каждый час с 9 до 18 по рабочим дням | 0 9-18 * * 1-5 |
	каждые два часа с 9 до 18 по рабочим дням | 0 */2 * * 1-5 |
	в 6:00 по рабочим дням | 0 6 * * 1-5 |
	в 12:00 в субботу | 0 12 * * 6 |

??? question "По какому времени отработает задача планировщика?"

	В зависимости от настройки часового пояса на сервере. Если настроено на МСК, то получается сдвиг на 2 часа вперед.

??? question "Как проверить формат файла pdf/a-1"
    
	Удостовериться, что формат созданного файла действительно pdf/a-1 можно с помощью [онлайн сервиса](https://avepdf.com/ru/pdfa-validation)

??? question "На деве и на продуктиве стоит одинаковая версия приложения, но на продуктиве сайт либо не открывается вообще, либо дает очень долгий отклик. В pg при этом скорости нормальные. В чем дело?"

	Одна из возможных причин — на сервере приложения установлены программы, которые либо отнимают память, либо блокируют действия других программ.
	Прежде всего, обратить внимание на наличие антивирусника и программы SELinux. SELinux блокирует действия, нарушающие текущую политику безопасности, фиксируя попытки в журнале.
	Решение: согласовать с заказчиком отключение этих программ либо изменение их настроек для сайтов Лексемы.

??? question "При авторизации на сайте в логах выходит ошибка: invalid page in block 2196 of relation base/349583/364737"

	**Способ 1:**
	1) В pgAdmin запустить Query Tool на базе сайта, где возникла ошибка.
	2) Выполнить:
	```sql
	SELECT pg_filenode_relation(0, 364737); -- в результате получаем имя таблицы
	```
	3) Запустить восстановление таблицы:
	```sql
	SET zero_damaged_pages = on;
	VACUUM FULL _document144;
	```
	4) Выполнить переиндексацию всей базы:
	```sql
	REINDEX DATABASE ИМЯБАЗЫ;
	```
	Источник: [https://www.sys-admin.su/postgresql-invalid-page-in-block-2196-of-relation-base-349583-364737/](https://www.sys-admin.su/postgresql-invalid-page-in-block-2196-of-relation-base-349583-364737/)
	**Способ 2:**
	1) В pgAdmin запустить Query Tool на базе сайта, где возникла ошибка.
	2) Выполнить:
	```sql
	SELECT pg_filenode_relation(0, 364737); -- в результате получаем имя таблицы
	```
	3) Попробовать удалить эту таблицу и создать ее заново. **ВАЖНО:** Предварительно сохранить данные из таблицы!
	**Способ 3:**
	Иногда помогает просто переиндексация всей базы:
	```sql
	REINDEX DATABASE ИМЯБАЗЫ;
	```

??? question "Где посмотреть максимально допустимый размер вложения на проекте"

	В деплое проекта в конфиге:
	1) Значение `maxSize` в разделе `file`.
	2) Параметр `client_max_body_size` в `nginx`.

??? question "Как подключить документ к СЭД?"

	1) Описать подключаемую форму в документе «Настройка документов». Прописать схему, название форм и т.д. Пример можно посмотреть на сайте демо.
	2) Подробнее про форму и её галки: [инструкция современной].
	3) Настроить вьюшку `DocflowExists` на каждом проекте отдельно, перечислив все таблицы, участвующие в документообороте.
	4) Настроить вьюшку `DocflowAccess`, задающую ограничения по правам.
	5) Обновить до последних стабильных версий Ядро (+все сопутствующие ядерные зависимости), Общие справочники и Карточки СЭД.
	6) Если планируется подписание ЭП — подключить сервис `dss`.
	7) Подключить в меню (`units.json`) документы.
	8) Если у документов предусмотрены подтипы — завести подтипы в реестре «Подтипы документов».
	9) Настроить шаблоны маршрутов.
	10) Если подключаете ЭП — сгенерировать гамма-последовательности на сервере (обратиться к системному администратору).
	11) В самих формах маршрут подключается при помощи:
	```javascript
	this.services.docflow.connectForm({ context: this, docArgs: args })
	```
	12) Подключить список рассылки, связки и вложения. Примеры: библиотека `ecosoft-lexema8-docflow-documents-lib` (Карточки СЭД).

??? question "При конвертации вложенного пользователем PDF выходит ошибка: Error while executing pdf-utils operations (because) xobjectsDictionary.has is not a function"

	Вложенный PDF имеет особенности, например, среди вертикальных страниц есть одна горизонтальная, либо PDF сформирован сторонним конвертером или встроенным в смартфон из фото в PDF.
	Рекомендуется:
	1) Изменить размеры страницы в данном PDF или произвести его сжатие.
	2) Утилиты:
	   - [https://www.pdf2go.com/ru/resize-pdf](https://www.pdf2go.com/ru/resize-pdf)
	   - [https://www.ilovepdf.com/ru/compress_pdf](https://www.ilovepdf.com/ru/compress_pdf)

??? question "После ввода кода авторизации в сервисе Telegram, поле phone_code_hash заполняется, но не появляется окно с успешной авторизацией"

	Одной из причин является включенный облачный пароль в настройках конфиденциальности номера, который используется в качестве отправителя.
	Проверить можно по инструкции. Если пароль отключен, рекомендуется:
	1) Перезапустить сервис Telegram.
	2) Почистить кэш с жесткой перезагрузкой страницы.
	3) Повторить авторизацию.

??? question "Как подключить планировщик задач?"

	Есть инструкция в [Word](Создание%20SchedulerUser.docx) по созданию и базовой настройке шедулера. 

??? question "При каких условиях пользователь видит документы в реестре?"

	1) Пользователь участвовал в маршруте согласования.
	2) Есть права в настройке пользователей на эти подразделения.
	3) Является инициатором документа.
	4) Участвовал в списке рассылки.
	5) Является руководителем по управленческой структуре (отображается только в универсальных документах).
	Если пользователь зашел под замещением, то отображаются также документы замещаемого.
	Если пользователь является внешним, необходимо в настройках пользователя указать подразделение.


??? question "Если во вложении к документу присутствует картинка в формате JPEG, то при скачивании архива с ЭП выходит ошибка наложения водяного знака"

	Проблемы:
	1) Большой вес файла.
	2) В ядре не предусмотрено превью для картинок.
	3) В коде для картинок своя ветка генерации отчета.
	Решение (костыль для получения отчета с водяным знаком):
	1) Скачать картинку.
	2) Конвертировать её из JPEG в PDF (можно уменьшить размер до 1.7 МБ).
	3) Сжать полученный PDF (до 70-80 КБ).
	4) Загрузить полученный PDF в базу так, чтобы получить `previewcontent` (например, в тестовое заявление).
	5) В `lex.file` у исходного файла в поле `previewcontent` установить значение из пункта 4.
	6) В `lex.file` у исходного файла в поле `convertationstatus` установить `done`.
	7) В `lex.file` у исходного файла в поле `ContentType` изменить `image/jpeg` на `application/pdf`.
	8) Скачать архив.
	9) В `lex.file` у исходного файла в поле `ContentType` вернуть `application/pdf` на `image/jpeg`.
	10) Вложить отчет с водяным знаком во вложения, так как скачивание архива не будет работать.
	**Глобальные решения:**
	**Вариант 1:**
	1) Установить запрет на вкладывание JPEG и/или файлов размером больше 1 МБ (требуется согласование с заказчиком).
	**Вариант 2:**
	1) Попросить у ядра конвертацию картинок в PDF и/или выяснить, почему это не реализовано.
	2) В ветке отчетов с водяным знаком направить картинки в ту же ветку, что и PDF.
	**Вариант 3:**
	1) В ветке отчетов с водяным знаком направить картинки в ту же ветку, что и PDF.
	2) На входе конвертировать картинки в PDF.

??? question "В журнале состояния документа не отображаются документы в какой-то определенной выборке"

	Проверить настройку ЖСД. Если в итоговой выборке присутствует условие:
	```sql
	WHERE t."DocumentCategory" IN (SELECT "VCode" FROM dfd."GetDocumentConstructorTypesByDocTypeProc"(t."DocType", t."orgId", lex."getLogin"()));
	```
	Проверить, что пользователь, у которого не показывается выборка, не уволен как сотрудник. В запросе `dfd."GetDocumentConstructorTypesByDocTypeProc"` идет проверка по ролям, горизонтальным правам, `RP_Worker` и т.д.

??? question "Как настроить в выборке ЖСД, чтобы документ был ссылочным?"

	В запросе добавить `"DocCode"`, `"DocType"`, `"DocForm"`, `"DocName"` и проставить галочку "Документ" на вкладке настройки.

??? question "При скачивании архива некоторые документы падают в таймаут"

	В `production.js` в блоке `jsreport` увеличить время параметра `reportTimeout`.

??? question "При открытии "Управление компаниями" выходит ошибка (в логах не записывается, только в консоли)"

	```sql
	SELECT * FROM lex."OrganizationUser" WHERE "User" IS NULL;
	```
	Сделать селект и удалить строки, где `User` IS NULL.

??? question "Не записываются последние логи в форму (обычно на новых проектах)"

	Сверить максимальные ключи у столбцов `Id` и `CDate`.
	Пример: у столбца `Id` счетчик 939868, а у `CDate` 157458.
	```sql
	SELECT * FROM lex."Log" ORDER BY "Id" DESC LIMIT 10;
	SELECT * FROM lex."Log" ORDER BY "CDate" DESC LIMIT 10;
	```

??? question "С определенной версии Chrome перестал поддерживать плагин КриптоПро ЭЦП Browser plug-in, с помощью которого было подписание УКЭП на проектах. КЭП не показывается в окне электронных подписей, и при подписании возникает ошибка"

	Установить браузеры:
	- Chromium-Gost
	- Яндекс.Браузер для организаций
	Либо воспользоваться инструкцией по [ссылке](https://docs.cryptopro.ru/cades/plugin/plugin-installation-windows?id=Установка-расширения-браузера).


## Мобильное приложение

??? question "При подписании в мобильном приложении возникает 500 статус"

	1) Посмотреть в веб-версии логи.
	2) Проверить, работает ли подписание этого документа этого пользователя в веб-версии.

??? question "При подключении к мобильному приложению выходит ошибка Network Error. Как это проверить?"

	С помощью сайта [https://www.sslshopper.com/ssl-checker.html](https://www.sslshopper.com/ssl-checker.html).
	В поле ввести адрес сайта, и нажать Check SSL. Все запросы должны быть зелеными.
	Если один из запросов с восклицательным знаком, обратиться к РП данного сайта, чтобы уточнить, кто системный администратор, и задать вопрос:
	"Проверили цепочку доверенных сертификатов по сайту на ресурсе [https://www.sslshopper.com/ssl-checker.html](https://www.sslshopper.com/ssl-checker.html). Результат выдает, что есть нарушения. Просьба устранить, так как эти нарушения влияют на работу мобильного приложения."