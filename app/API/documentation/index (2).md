---
search:
  boost: 3 
---
# Автоматическое создание пользователей

## Создание пользователей

Пользователь, выполняющий функцию автоматической загрузки пользователей, должен обладать правами администратора.

Для автоматического создания пользователей необходимо:

* Установить последнюю версию вспомогательной **библиотеки функций управления пользователями для планировщика задач**.
* Установить последнюю версию библиотеки **Управление пользователями**.
* Настроить задачу ["Создание новых пользователей"](../Функции планировщика задач/index.md) в [планировщике задач](../Планировщик задач/index.md) с указанием расписания выполнения (например каждый день в 9 часов). Необходимо обратить внимание, чтобы в документе [Физическое лицо](https://ecm-user-manuals.readthedocs.io/ru/latest/User%20manuals/Физические%20лица/), во вкладке "Контакты" было заполнено поле "Почта".
![Почта](media/mail.png)
* Настроить константу **способ регистрации по умолчанию** с указанным значением (текст) **Lexema** для того, чтобы по умолчанию создавались недоменные пользователи. Про создание доменных пользователей можно ознакомиться [ниже](#https://ecm-user-manuals\.readthedocs\.io/ru/latest/).

![Лексема](media/lexema.png)

Процедура создания работает посредством сопоставлений со справочниками [Физическое лицо](https://ecm-user-manuals.readthedocs.io/ru/latest/User%20manuals/Физические%20лица/) и [Сотрудники](https://ecm-user-manuals.readthedocs.io/ru/latest/User%20manuals/Сотрудники/). Данная задача является базовой для всех ниже указанных способов создания пользователей. Поэтому справочники **"Физическое лицо"** и **"Сотрудники"** должны быть загружены заранее.

![Задача](media/taskCreat.png)

!!! note
    Если в контактах физического лица явно указан вид авторизации, то настраивать константу необязательно
    
    ![Вид авторизации](media/vidAvtor2.png)

## Уведомление пользователя о регистрации в системе

Для информирования пользователя о создании его учетной записи в системе нужно:

* Выполнить шаги, описанные в разделе [Создание пользователей](#создание_пользователей), если это не было сделано ранее.
* В настройках учетной политики настроить константу **УпрП_уведомление_о_создание_УЗ** со значением 1. 

![Константа уведомления о создании](media/constPush.png)

## Повторное уведомление пользователя о регистрации пользователя

В случае если пользователь в течение определенного времени не прошел авторизацию, необходимо повторно оповестить его о необходимости ее прохождения. Повторное уведомление будет отправляться до тех пор, пока пользователь не пройдет авторизацию. Для этого необходимо настроить задачу [Напоминание о входе в систему неактивированным пользователям](../Функции планировщика задач/index.md) в [планировщике задач](../Планировщик задач/index.md) с настройкой расписания для автоматической отправки (например оповещать каждый день в 12 часов)  и настроить в настройках учетной политики константу **УпрП_напоминание_о_созданной_УЗ** со значением 1.

![Задача](media/taskReminder.png)
![Константа уведомления о напоминании](media/constReminder.png)

## Cоздание пользователей с доменными учетными записями
Доменная авторизация позволяет проверить подлинность данных на стороннем ресурсе. Подробнее можно почитать в разделе [Доменная авторизация](../Авторизация/Виды авторизации/#доменная_авторизация)

**Для импорта доменных учетных записей и автоматического создания пользователей нужно выполнить следующее:**

* Выполнить шаги, описанные в разделе [Создание пользователей](#создание_пользователей), если это не было сделано ранее.
* Настроить константу **УпрП_поля_из_AD_для_сравнения**. В значениях необходимо указать по каким условиям производить сравнение. Условие может быть как одно так и несколько, указываются через запятую: firstName (имя), lastName (фамилия), email (почта), loginAndEmail (логин и почта), loginOrEmail (логин или почта)
![](./media/Up_srav.png)
* Настроить задачу [Загрузка пользователей из Active Directory в форму для сопоставления](../Функции планировщика задач/index.md) и расписание для автоматического выполнения задачи (например в 4 часа 30 минут с понедельника по пятницу).
![Задача](media/taskAD.png)
* Настроить константу **способ регистрации по умолчанию** с указанным значением (текст) **ActiveDirectory** для того, чтобы по умолчанию создавались доменные пользователи.

![](./media/constant.png)

!!! note
    Если в контактах физического лица явно указан вид авторизации, то настраивать константу необязательно
    
    ![Вид авторизации](media/vidAvtor.png)
 
## Cоздание пользователей с доменными учетными записями и аутентификацией через SSO

Для автоматического создания пользователей, необходимо необходимо:

* Выполнить шаги, описанные в разделе [Создание пользователей](#создание_пользователей), если это не было сделано ранее.
* Выполнить шаги, описанные в разделе [Cоздание пользователей с доменными учетными записями](#cоздание_пользователей_с_доменными_учетными_записями), если это не было сделано ранее.
* В настройках учетной политики настроить константу **УпрП_SSO** с необходимым доменом в столбец "Значение(текст)"

![Константа](media/constantSSO.png)